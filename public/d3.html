<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<link rel="stylesheet" type="text/css" href="./myCSS.css">
		<!-- link rel="stylesheet" type="text/css" href="./rickshaw.min.css" -->		
		<script type='text/javascript' src='http://d3js.org/d3.v2.js'></script>    	
		<script type='text/javascript' src="rickshaw.min.js"></script> 		
		<title>
		</title>
	</head>
  	<body>
		<div id='chartSpace'></div>
			<!--svg id='chart'-->
		</body>
	<script>

		var clientCodeDebug = 'high'; // need to actually pass its value from the server 
		//var chart = d3.select("#chart");		
		//var chart = d3.select("#chartSpace").append("svg:svg");
		var data;
		
		function d3VisualSanity() {
			// sanity checking d3 is working by drawing a meaningless box
			// the page will typically never invoke it but it can be invoked 
			// from the browser console
			chart.append("svg:rect").attr("x", 100).attr("y", 100).attr("width", 100).attr("height", 100); }
			
		function loadCSV(fileName) {
			// this function is no good for real-world interactions, as the callback can't
			// be dynamically told where to put the loaded data, and also because it can't
			// use https only http. 
			d3.csv(fileName, function(csvData) 
			{
				if (csvData) 
				{
					data = csvData;
					if (clientCodeDebug == 'high') {
						//show the data as a browsable browser console object
						console.dir(data);
						dataReady(); }
					else;
				}
				else 
					alert("failed loading data file" + fileName);
			}); }
	
		function initializeView() {
			// benign page load transitions
			var chartSpace = d3.select("#chartSpace");
			chartSpace.transition().style("margin-top", "10%").duration(1000).ease("cubic-in-out");				
			d3.select("body").transition()
				.style("background-color", "white")
				.duration(500).ease("linear"); }
		
		function rickshawChart() {
			var graph = new Rickshaw.Graph( {
				element: document.querySelector("#chartSpace"), 
				renderer: 'line',				
				series: [{
					color: 'green',
					data: [ 
						{ x: 0, y: 40 }, 
						{ x: 1, y: 49 }, 
						{ x: 2, y: 38 }, 
						{ x: 3, y: 30 }, 
						{ x: 4, y: 32 } ]
				}]
			});
 
			graph.render();	}
			
		function dataReady() {
			var series1 = data;
			console.dir(series1);
			rickshawChart();
		}
		
		initializeView();
		
		// pull csv file from the server, asynchronously for now
		loadCSV("table1.csv");		

		// Parse dates and numbers. We assume values are sorted by date.
		// parse = d3.time.format("%c").parse;	// format specifiers at http://tinyurl.com/cmakk7e

		
	</script>
</html>
